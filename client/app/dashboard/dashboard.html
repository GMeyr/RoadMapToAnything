<script type="text/javascript">
  $( document ).ready(function(){ 
    // $.get('app/modals/creation.html', function (modal) {
    //   $('#creation-modal').append(modal);
    // });
    $(".dropdown-button").dropdown();
    $('.modal-trigger').leanModal({ 
      dismissible: true,
      complete: function() {
        $('.lean-overlay').remove();
      }
    });
  });
</script>

<div class="container">
  <div class="dash-buttons">
    <a id="followedBtn" class="btn pressed" ng-click="changeToFollowed()">Maps I Follow</a>
    <a id="myMapsBtn" class="btn" ng-click="changeToMyMaps()">Maps I Made</a>
   <a id="myMapsBtn" class="btn" ng-click="changeToCompleted()">Maps I Completed</a>
  </div>

  <div class="dash-tables">

    <!--Maps I Follow-->
    <div class="dash-table" ng-show="showFollowed">
      <div class="follow-title"><h5>Maps I Follow</h5></div>
      <div class="follow-maps">
        <table class="bordered striped highlight0+56+">
          <tbody>
            <tr>
              <th>Nodes</th>
              <th>Roadmap</th>
              <th>Progress Bar</th>
              <th>Unfollow</th>
            </tr>
          </tbody>
          <tbody class="follow-map" ng-repeat="map in followed">
            <tr>
              <td>{{ map.nodesCompleted }} /
              {{ map.nodes.length }}</td>
              <td class="truncate" ng-click="goToMap( map._id )">
                <span class="mousetoHand">{{ map.title }}</span>
              </td>
              <td class="progress-bar">
                <div class="progress">
                  <div class="determinate" ng-style="{'width': map.percentComplete + '%'}"></div>
                </div>
              </td>
              <td>
                <a ng-click="unfollowMap( map._id )">
                <span class="mousetoHand">Unfollow</span></a>
              </td>
            </tr>
        </tbody>
        </table>
        <div class="card hoverable grey lighten-4" ng-show="!followed.length">
          <div class="card-content center-align">
            <h5>You haven't followed any Roadmaps!</h5>
            Find the perfect one <a ui-sref="home.browse">on our browse page.</a>
          </div>
        </div>
      </div>
    </div>

    <!--Maps I Made-->
    <div class="dash-table" ng-show="showMyMaps">
      <div class="made-title"><h5>Maps I Made</h5></div>
      <div class="made-maps">
        <table class="bordered striped highlight">
          <tbody>
            <tr>
              <th>Nodes</th>
              <th>Roadmap</th>
              <th>Delete</th>
            </tr>
          </tbody>
          <tbody class="follow-map" ng-repeat="map in myMaps">
            <tr>
              <td>{{ map.nodes.length }}</td>
              <td class="truncate" ng-click="goToMap( map._id )">
                <span class="mousetoHand">{{ map.title }}</span>
              </td>
              <td>
                <a ng-click="deleteMap( map._id )"><span class="mousetoHand">Delete</span></a>
              </td>
            </tr>
        </tbody>
        </table>
        <div class="card hoverable grey lighten-4" ng-show="!myMaps.length">
          <div class="card-content center-align">
            <h5>You haven't made any Roadmaps!</h5>
            Drop some knowledge on the world <a class="modal-trigger" href="#creation-modal">by building one</a> now.
          </div>
        </div>
      </div>
    </div>

        <!--Maps I Completed-->
    <div class="dash-table" ng-show="showCompleted">
      <div class="made-title"><h5>Maps I Completed</h5></div>
      <div class="made-maps">
        <table class="bordered striped highlight">
          <tbody>
            <tr>
              <th>Nodes</th>
              <th>Roadmap</th>
            </tr>
          </tbody>
          <tbody class="follow-map" ng-repeat="map in completed">
            <tr>
              <td>{{ map.nodes.length }}</td>
              <td class="truncate" ng-click="goToMap( map._id )">
                <span class="mousetoHand">{{ map.title }}</span>
              </td>
            </tr>
        </tbody>
        </table>
        <div class="card hoverable grey lighten-4" ng-show="!followed.length">
          <div class="card-content center-align">
            <h5>You haven't completed any Roadmaps yet</h5>
            But don't worry, we know you'll finish one soon!
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Create Roadmap/Node Popup -->
<div id="creation-modal" class="modal" ng-controller="CreationController">
<!-- Create Roadmap/Node Popup -->
  <div class="modal-content">

    <!-- Roadmap Form -->

    <h3>Create A Roadmap</h3>
    <div class="row">
      <form class="col s12">
        <div class="row">
          <div class="input-field col s8">
            <input id="roadmap_title" type="text" class="validate" ng-model="roadmapTitle" required>
            <label for="roadmap_title">Give it a title</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s12">
            <input id="roadmap_description" type="text" class="validate" ng-model="roadmapDescription" required>
            <label for="roadmap_description">Tell us about it</label>
          </div>
        </div>
      </form>
    </div>

    <!-- Node Form -->
    <h4 ng-click="test()">Add a node</h4>
    <div class="row">
      <form class="col s12" name="nodeForm">
        <div class="row">
          <div class="input-field col s8">
            <input id="node_title" type="text" class="validate" ng-model="nodeTitle" input>
            <label for="node_title">Title the node</label>
          </div>
          <div class="input-field col s4">
            <select ng-model="nodeType">
              <option value="Blog Post" selected>Blog Post</option>
              <option value="Class">Class</option>
              <option value="Video">Video</option>
              <option value="Music">Music</option>
            </select>
            <label>What is it?</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s12">
            <input id="node_description" type="text" class="validate" ng-model="nodeDescription" required>
            <label for="node_description">Describe this step</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s6">
            <input id="node_url" type="url" class="validate" ng-model="nodeUrl">
            <label for="node_url">What's the link? (optional)</label>
          </div>
          <div class="input-field col s6">
            <input id="node_image_url" type="url" class="validate" ng-model="nodeImageUrl">
            <label for="node_image_url">Link an image (optional)</label>
          </div>
        </div>
        <div class="row">
            <button class="btn waves-effect waves-light" type="submit" onclick="reset()" ng-click="submitAndRefresh()" name="action">Add Another Node
            </button>
            <a href="#!" class="modal-action modal-close"><button class="modal-action btn waves-effect waves-light" type="submit" ng-click="submitAndExit()" name="action">Add Node and Finish
            </button></a>
        </div>
      </form>
    </div>
  </div>
</div>
